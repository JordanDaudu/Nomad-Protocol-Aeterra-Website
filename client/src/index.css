@import "tailwindcss";
@import "tw-animate-css";

@plugin "tailwindcss-animate";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --font-sans: "Space Grotesk", sans-serif;
  --font-mono: "JetBrains Mono", monospace;
  --font-body: "Inter", sans-serif;

  --color-background: hsl(0 0% 5%); /* Near black #0d0d0d */
  --color-foreground: hsl(0 0% 88%); /* Soft white #e0e0e0 */
  
  --color-card: hsl(0 0% 8%);
  --color-card-foreground: hsl(0 0% 88%);
  
  --color-popover: hsl(0 0% 8%);
  --color-popover-foreground: hsl(0 0% 88%);
  
  --color-primary: hsl(270 60% 65%); /* Corrupted Violet */
  --color-primary-foreground: hsl(0 0% 100%);
  
  --color-secondary: hsl(190 80% 40%); /* Muted Cyan */
  --color-secondary-foreground: hsl(0 0% 100%);

  --color-terminal: hsl(142 71% 45%); /* Terminal Green (Emerald) */
  --color-terminal-dark: hsl(142 76% 36%); /* Darker (Emerald 600) */
  --color-terminal-dim: hsl(142 71% 45% / 0.1); /* 10% Opacity version */
  
  --color-muted: hsl(0 0% 15%);
  --color-muted-foreground: hsl(0 0% 60%);
  
  --color-accent: hsl(35 80% 50%); /* Amber warning */
  --color-accent-foreground: hsl(0 0% 10%);
  
  --color-destructive: hsl(0 60% 50%);
  --color-destructive-foreground: hsl(0 0% 100%);
  
  --color-border: hsl(0 0% 20%);
  --color-input: hsl(0 0% 20%);
  --color-ring: hsl(270 60% 65%);

  --radius-sm: 0px;
  --radius-md: 2px;
  --radius-lg: 4px;
}

:root {
  color-scheme: dark;
}

body {
  @apply bg-background text-foreground font-body overflow-x-hidden;
  background-image: 
    linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%),
    linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
  background-size: 100% 2px, 3px 100%;
}

/* Scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}
::-webkit-scrollbar-track {
  background: hsl(0 0% 8%);
}
::-webkit-scrollbar-thumb {
  background: hsl(0 0% 25%);
  border: 1px solid hsl(0 0% 8%);
}
::-webkit-scrollbar-thumb:hover {
  background: hsl(270 60% 65%);
}

/* Typography Utilities */
.font-display {
  font-family: var(--font-sans);
}
.font-terminal {
  font-family: var(--font-mono);
}

/* CRT / Scanline Effects */
.scanlines::before {
  content: " ";
  display: block;
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
  z-index: 50;
  background-size: 100% 2px, 3px 100%;
  pointer-events: none;
}

.flicker {
  animation: flicker 0.15s infinite;
}

@keyframes flicker {
  0% { opacity: 0.97; }
  50% { opacity: 1; }
  100% { opacity: 0.98; }
}

/* Markdown Content Styling */
.prose {
  @apply text-foreground/90 max-w-none;
}
.prose h1, .prose h2, .prose h3 {
  @apply font-sans text-foreground font-bold uppercase tracking-wide border-b border-border/50 pb-2 mb-4 mt-8;
}
.prose h1 { @apply text-3xl text-primary; }
.prose h2 { @apply text-2xl; }
.prose h3 { @apply text-xl text-secondary; }
.prose p { @apply mb-4 leading-relaxed; }
.prose ul { @apply list-disc list-outside ml-6 mb-4 space-y-1; }
.prose code { @apply font-mono bg-muted/50 px-1 py-0.5 text-sm text-secondary; }
.prose pre { @apply bg-black/50 border border-border p-4 mb-4 overflow-x-auto; }
.prose pre code { @apply bg-transparent text-foreground p-0; }
.prose blockquote { @apply border-l-2 border-accent pl-4 italic text-muted-foreground bg-muted/10 py-2 my-4; }
.prose img { @apply border border-border/50 bg-black/50 p-1 w-full max-w-3xl mx-auto my-6; }
.prose hr { @apply border-border my-8; }

/* Glitch Effect Utility */
.glitch-text {
  position: relative;
}
.glitch-text::before,
.glitch-text::after {
  content: attr(data-text);
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}
.glitch-text::before {
  left: 2px;
  text-shadow: -1px 0 #ff00c1;
  clip: rect(44px, 450px, 56px, 0);
  animation: glitch-anim 5s infinite linear alternate-reverse;
}
.glitch-text::after {
  left: -2px;
  text-shadow: -1px 0 #00fff9;
  clip: rect(44px, 450px, 56px, 0);
  animation: glitch-anim2 5s infinite linear alternate-reverse;
}

@keyframes glitch-anim {
  0% { clip: rect(72px, 9999px, 83px, 0); }
  20% { clip: rect(6px, 9999px, 83px, 0); }
  40% { clip: rect(98px, 9999px, 2px, 0); }
  60% { clip: rect(13px, 9999px, 38px, 0); }
  80% { clip: rect(87px, 9999px, 47px, 0); }
  100% { clip: rect(31px, 9999px, 12px, 0); }
}

@keyframes glitch-anim2 {
  0% { clip: rect(65px, 9999px, 100px, 0); }
  20% { clip: rect(44px, 9999px, 6px, 0); }
  40% { clip: rect(13px, 9999px, 83px, 0); }
  60% { clip: rect(87px, 9999px, 16px, 0); }
  80% { clip: rect(2px, 9999px, 91px, 0); }
  100% { clip: rect(55px, 9999px, 38px, 0); }
}


@layer utilities {
  @keyframes glitch {
    0% {
      transform: translate(0);
      text-shadow: -2px 0 #b478ff, 2px 0 #00ffff;
    }
    20% {
      transform: translate(-2px, 1px);
      text-shadow: 2px 0 #b478ff, -2px 0 #00ffff;
    }
    40% {
      transform: translate(-2px, -1px);
      text-shadow: -1px 0 #b478ff, 1px 0 #00ffff;
    }
    60% {
      transform: translate(2px, 1px);
      text-shadow: 2px 0 #b478ff, -1px 0 #00ffff;
    }
    80% {
      transform: translate(2px, -1px);
      text-shadow: -2px 0 #b478ff, 2px 0 #00ffff;
    }
    100% {
      transform: translate(0);
    }
  }

  .animate-glitch-hover:hover {
    animation: glitch 0.6s cubic-bezier(.25, .46, .45, .94) both infinite;
  }
}

@layer utilities {
  /* Subtle flicker for the [CRIT] and [WARN] tags */
  @keyframes status-flicker {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
    52% { opacity: 1; }
    54% { opacity: 0.4; }
    56% { opacity: 1; }
  }

  .animate-status-flicker {
    animation: status-flicker 3s linear infinite;
  }
}

@keyframes scan-glint {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

.animate-scan {
  animation: scan-glint 3s linear infinite;
}

/* Systems Archive Tree */
.tree-item-active {
  box-shadow: inset 0 0 8px rgba(var(--color-primary), 0.1);
}
.tree-item:hover {
  text-shadow: 0 0 6px rgba(255, 255, 255, 0.05);
}
@keyframes subtle-glow {
  0%, 100% { box-shadow: inset 0 0 4px rgba(168, 85, 247, 0.05); }
  50% { box-shadow: inset 0 0 8px rgba(168, 85, 247, 0.1); }
}
.tree-item-active {
  animation: subtle-glow 3s ease-in-out infinite;
}
.systems-tree-sidebar {
  scrollbar-width: thin;
  scrollbar-color: hsl(0 0% 25%) transparent;
}

/* Systems Archive layout */
.systems-archive .prose {
  @apply text-foreground/90;
}
.systems-archive .prose table {
  @apply w-full border-collapse;
}

.systems-archive .prose h2 {
  @apply text-xl;
}